<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MyHomesBudget · Redirect</title>

  <!-- Non indicizzare la root-redirect -->
  <meta name="robots" content="index,follow">

  <!-- Canonical/Hreflang verso le versioni localizzate -->
  <link rel="canonical" href="https://www.myhomesbudget.com/"/>
  <link rel="alternate" href="https://www.myhomesbudget.com/it/" hreflang="it"/>
  <link rel="alternate" href="https://www.myhomesbudget.com/en/" hreflang="en"/>
  <link rel="alternate" href="https://www.myhomesbudget.com/es/" hreflang="es"/>
  <link rel="alternate" href="https://www.myhomesbudget.com/" hreflang="x-default"/>

  <!-- CSP minima compatibile con inline script -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline'; base-uri 'self'">

  <style>
    body{margin:0;display:grid;place-items:center;height:100dvh;background:#0f0f10;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    .box{max-width:640px;padding:24px;text-align:center;opacity:.9}
  </style>

  <!-- Redirect client-side -->
  <script>
  (function(){
    // Se siamo già su una lingua, non fare nulla
    if (/^\/(it|en|es)(\/|$)/i.test(location.pathname)) return;

    // 1) Preferenza salvata
    try{
      var m = document.cookie.match(/(?:^|;)\s*mhb_lang=(it|en|es)/i);
      var pref = (m && m[1]) || localStorage.getItem('mhb_lang');
      if (pref) { location.replace('/' + pref.toLowerCase() + '/'); return; }
    }catch(e){}

    // 2) Lingua browser
    var l = (navigator.languages && navigator.languages[0] || navigator.language || 'it').toLowerCase();
    var base = l.split('-')[0];
    var map = { it:'it', en:'en', es:'es' };
    var dest = map[base] || 'it';

    // 3) Ricorda per la prossima volta
    try {
      document.cookie = 'mhb_lang='+dest+';path=/;max-age='+(60*60*24*365);
      localStorage.setItem('mhb_lang', dest);
    } catch(e){}

    location.replace('/' + dest + '/');
  })();
  </script>

  <noscript>
    <meta http-equiv="refresh" content="0; url=/it/">
  </noscript>
</head>
<body>
  <div class="box">
    <h1>Reindirizzamento…</h1>
    <p>Ti stiamo portando alla versione corretta del sito.</p>
    <p style="opacity:.7">Se non succede, <a href="/it/" style="color:#00cec9">clicca qui</a>.</p>
  </div>
</body>
</html>

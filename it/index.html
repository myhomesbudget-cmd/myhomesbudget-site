<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MyHomesBudget ‚Äî Bilancio familiare semplice</title>
  <meta name="description" content="Gestisci entrate, spese e risparmi in modo semplice. Prova gratis per 30 giorni.">

  <!-- CSP -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' https: data:;
                 style-src 'self' 'unsafe-inline';
                 script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com;
                 connect-src 'self' https://www.google-analytics.com https://region1.google-analytics.com;
                 font-src 'self' https: data:;
                 frame-ancestors 'none';
                 base-uri 'self';
                 form-action 'self'">

  <!-- GA4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LSD3V9G957"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-LSD3V9G957', { anonymize_ip: true });
  </script>

  <!-- Redirect dopo verifica email -->
  <script>
    (function(){
      function itPrefix(){
        var m = location.pathname.match(/^\/(it|ita)(\/|$)/i);
        return m ? ("/" + m[1].toLowerCase() + "/") : "/it/";
      }
      var prefix = itPrefix();
      var q = new URLSearchParams(location.search);
      var hash = location.hash || '';
      var verified =
        q.get('verified') === '1' ||
        q.get('status') === 'verified' ||
        q.get('confirmed') === '1' ||
        hash.includes('verified');
      if (!verified) return;

      try {
        localStorage.setItem('email_verified','1');
        localStorage.setItem('last_verified', String(Date.now()));
      } catch(e){}
      var done = false;
      try { done = (localStorage.getItem('onboarding_completed') === '1'); } catch(e){}
      var dest = done ? 'dashboard.html' : 'onboarding.html';
      try { if (typeof gtag === 'function') gtag('event','verified_entry_redirect',{ dest: done ? 'dashboard' : 'onboarding', lang:'it' }); } catch(e){}
      location.replace(prefix + dest);
    })();
  </script>

  <!-- Social/SEO -->
  <link rel="canonical" href="https://www.myhomesbudget.com/it/"/>
  <link rel="alternate" href="https://www.myhomesbudget.com/it/" hreflang="it"/>
  <link rel="alternate" href="https://www.myhomesbudget.com/en/" hreflang="en"/>
  <link rel="alternate" href="https://www.myhomesbudget.com/es/" hreflang="es"/>
  <link rel="alternate" href="https://www.myhomesbudget.com/" hreflang="x-default"/>
  <meta property="og:title" content="MyHomesBudget ‚Äî Gestisci il tuo bilancio domestico in modo semplice e intuitivo"/>
  <meta property="og:description" content="Inserisci le tue spese e le entrate in pochi click e tieni tutto sotto controllo. Prova gratis per 30 giorni."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://www.myhomesbudget.com/it/"/>
  <meta property="og:image" content="https://www.myhomesbudget.com/social.png"/>
  <meta name="twitter:card" content="summary_large_image"/>

  <!-- Perf -->
  <link rel="preload" href="/bg.webp" as="image" imagesrcset="/bg.webp"/>
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
  <link rel="preconnect" href="https://region1.google-analytics.com" crossorigin>
  <link rel="icon" href="/favicon.ico">
  <meta name="theme-color" content="#0f0f10">
  <meta name="color-scheme" content="light dark">

  <style id="mhb-landing-enhance">
    :root{
      --grad-primary: linear-gradient(135deg,#6c5ce7,#00cec9);
      --glass-bg: rgba(255,255,255,0.08);
      --glass-border: rgba(255,255,255,0.12);
      --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
      --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:-apple-system,system-ui,"Segoe UI",Roboto,sans-serif;
      color:#fff;overflow-x:hidden;
      /* MODIFICA: Colore di sfondo cambiato */
      background:#a4a4fc url("/bg.webp") no-repeat center/cover fixed;
      position:relative;
    }
    body.mobile-nav-is-open {
      /* Non pi√π necessario bloccare lo scroll per il dropdown */
    }
    body::before{
      content:"";position:fixed;inset:0;
      background:linear-gradient(135deg, rgba(108,92,231,0.12) 0%, rgba(0,206,201,0.12) 100%);
      animation:breatheGradient 12s ease-in-out infinite;
      z-index:-1;pointer-events:none;
    }
    body::after{
      content:"";position:fixed;inset:0;
      background:rgba(255,255,255,0.02);
      z-index:-1;pointer-events:none;
    }
    @keyframes breatheGradient{
      0%,100%{opacity:0.12}
      50%{opacity:0.18}
    }
    @media (prefers-reduced-motion:reduce){
      body::before{animation:none}
    }
    a:focus-visible,button:focus-visible{
      outline:3px solid #00cec9;outline-offset:3px;border-radius:8px;
    }

    /* ========== TOPBAR ========== */
    .topbar{
      position:fixed;top:0;left:0;right:0;z-index:100;
      background:rgba(15,15,16,0.7);backdrop-filter:blur(12px);
      border-bottom:1px solid var(--glass-border);
      transition:transform 0.3s var(--ease-smooth);
    }
    .topbar.hidden{transform:translateY(-100%)}
    .topbar-inner{
      max-width:1200px;margin:0 auto;padding:12px 20px;
      display:flex;align-items:center;justify-content:space-between;gap:16px;
    }
    .logo-link{
      display:flex;align-items:center;gap:10px;text-decoration:none;
    }
    .logo-image{height:36px;width:auto}
    .logo-text{
      font-weight:700;font-size:1.1rem;color:#fff;
      background:var(--grad-primary);
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .topbar-actions{
      display:flex;align-items:center;gap:12px;
    }
    .top-link{
      padding:8px 16px;border-radius:8px;font-weight:700;font-size:0.95rem;
      text-decoration:none;color:#fff;
      background:var(--glass-bg);border:1px solid var(--glass-border);
      transition:all 0.2s var(--ease-smooth);
    }
    .top-link:hover{
      background:rgba(255,255,255,0.14);transform:translateY(-1px);
    }
    .top-link.primary{
      background:var(--grad-primary);border:none;
    }
    .top-link.primary:hover{
      filter:brightness(1.1);
    }
    .lang-selector{display:flex;gap:6px;font-size:1.3rem}
    .lang-selector a{
      text-decoration:none;padding:6px 8px;border-radius:6px;
      transition:background 0.2s;
    }
    .lang-selector a:hover{background:rgba(255,255,255,0.1)}
    .user-greeting{
      display:flex;align-items:center;gap:8px;color:#fff;font-size:0.95rem;
    }
    .btn-logout{
      padding:6px 12px;border-radius:6px;font-size:0.9rem;font-weight:600;
      background:rgba(255,59,48,0.15);border:1px solid rgba(255,59,48,0.3);
      color:#ff3b30;cursor:pointer;transition:all 0.2s;
    }
    .btn-logout:hover{
      background:rgba(255,59,48,0.25);transform:translateY(-1px);
    }

    /* ========== STICKY CTA BAR ========== */
    .sticky-cta-bar{
      position:fixed;top:0;left:0;right:0;z-index:99;
      background:rgba(15,15,16,0.95);backdrop-filter:blur(16px);
      border-bottom:1px solid var(--glass-border);
      padding:12px 20px;
      display:flex;align-items:center;justify-content:center;gap:16px;
      transform:translateY(-100%);
      transition:transform 0.4s var(--ease-smooth);
      box-shadow:0 4px 12px rgba(0,0,0,0.2);
    }
    .sticky-cta-bar.visible{transform:translateY(0)}
    .sticky-cta-bar .mini-headline{
      font-weight:700;font-size:0.95rem;color:#fff;
    }
    .sticky-cta-bar .btn{
      padding:8px 16px;border-radius:8px;font-weight:700;font-size:0.9rem;
      text-decoration:none;transition:all 0.2s;
    }
    .sticky-cta-bar .btn-primary{
      background:var(--grad-primary);color:#fff;border:none;
    }
    .sticky-cta-bar .btn-primary:hover{filter:brightness(1.1)}
    .sticky-cta-bar .btn-secondary{
      background:var(--glass-bg);color:#fff;border:1px solid var(--glass-border);
    }
    .sticky-cta-bar .btn-secondary:hover{background:rgba(255,255,255,0.14)}

    /* ========== MAIN CONTAINER ========== */
    .container{
      max-width:1200px;margin:0 auto;padding:0 20px;
    }

    /* ========== HERO SECTION ========== */
    .hero-section{
      min-height:90vh;display:flex;align-items:center;justify-content:center;
      padding:100px 20px 60px;position:relative;overflow:hidden;
    }
    .hero-orb{
      position:absolute;width:600px;height:600px;border-radius:50%;
      background:radial-gradient(circle, rgba(108,92,231,0.2) 0%, transparent 70%);
      filter:blur(80px);pointer-events:none;
      animation:floatOrb 20s ease-in-out infinite;
    }
    @keyframes floatOrb{
      0%,100%{transform:translate(0,0) scale(1)}
      33%{transform:translate(30px,-20px) scale(1.05)}
      66%{transform:translate(-20px,30px) scale(0.95)}
    }
    @media (prefers-reduced-motion:reduce){
      .hero-orb{animation:none}
    }
    .hero-content{
      position:relative;z-index:2;max-width:1100px;width:100%;
    }

    /* HERO V1: testo sx + mockup dx */
    .hero-v1{
      display:grid;grid-template-columns:1fr 1fr;gap:60px;align-items:center;
    }
    @media(max-width:900px){
      .hero-v1{grid-template-columns:1fr;gap:40px;text-align:center}
    }
    .hero-text h1{
      font-size:clamp(2.2rem,5vw,3.5rem);line-height:1.15;margin-bottom:16px;
      font-weight:800;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,0.3);
    }
    .hero-text .headline-rotating{
      display:inline-block;min-height:1.2em;
      background:var(--grad-primary);
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .hero-text p{
      font-size:1.25rem;line-height:1.6;color:rgba(255,255,255,0.9);
      margin-bottom:24px;
    }
    .hero-cta-row{
      display:flex;gap:12px;flex-wrap:wrap;
    }
    @media(max-width:900px){
      .hero-cta-row{justify-content:center}
    }
    .hero-cta-row .btn{
      padding:14px 28px;border-radius:12px;font-weight:800;font-size:1rem;
      text-decoration:none;transition:all 0.3s var(--ease-smooth);
      box-shadow:0 8px 24px rgba(0,0,0,0.15);
    }
    .hero-cta-row .btn-primary,
    .hero-cta-row .btn-secondary { /* MODIFICA: Unificato stile pulsanti hero */
      background:var(--grad-primary);color:#fff; border: none;
    }
    .hero-cta-row .btn-primary:hover,
    .hero-cta-row .btn-secondary:hover { /* MODIFICA: Unificato stile hover */
      transform:translateY(-2px);box-shadow:0 12px 32px rgba(0,0,0,0.25);
      filter:brightness(1.1);
    }
    .hero-mockup{
      position:relative;
    }
    .hero-mockup img{
      width:100%;height:auto;border-radius:16px;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
      transition:transform 0.3s var(--ease-smooth);
    }
    .hero-mockup:hover img{
      transform:scale(1.02);
    }

    /* HERO V2: mockup centrale + headline sotto */
    .hero-v2{
      text-align:center;
    }
    .hero-v2 .hero-mockup{
      max-width:700px;margin:0 auto 32px;
      background:var(--glass-bg);backdrop-filter:blur(12px);
      border:1px solid var(--glass-border);border-radius:20px;padding:20px;
    }
    .hero-v2 .hero-mockup img{
      width:100%;height:auto;border-radius:12px;
    }
    .hero-v2 h1{
      font-size:clamp(2rem,4.5vw,3rem);line-height:1.2;margin-bottom:16px;
      font-weight:800;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,0.3);
    }
    .hero-v2 p{
      font-size:1.2rem;line-height:1.6;color:rgba(255,255,255,0.9);
      margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;
    }
    .hero-v2 .hero-cta-row{
      justify-content:center;
    }

    /* ========== TRUST ROW ========== */
    .trust-row{
      padding:40px 20px;text-align:center;
    }
    .trust-pills{
      display:flex;gap:16px;justify-content:center;flex-wrap:wrap;
    }
    /* MODIFICA: Stile trust-pill aggiornato */
    .trust-pill{
      padding:12px 24px;border-radius:12px; /* MODIFICA: Angoli meno arrotondati per effetto bottone */
      background:var(--grad-primary);
      backdrop-filter:blur(8px);
      border: none;
      font-size:0.95rem;font-weight:600;color:#fff;
      transition:all 0.3s var(--ease-smooth);
      position:relative;overflow:hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    .trust-pill::before{
      display: none;
    }
    .trust-pill:hover{
      transform:translateY(-2px) scale(1.02);
      box-shadow:0 8px 24px rgba(108,92,231,0.4);
    }
    
    /* ========== DEMO-LIGHT ========== */
    .demo-section{
      padding:60px 20px;
    }
    .demo-box{
      max-width:1000px;margin:0 auto;
      background:var(--glass-bg);backdrop-filter:blur(12px);
      border:2px solid transparent;
      background-clip:padding-box;
      border-radius:20px;
      padding:32px;text-align:center;
      position:relative;overflow:hidden;
    }
    .demo-box::before{
      content:'';position:absolute;inset:-2px;
      background:linear-gradient(135deg,rgba(108,92,231,0.3),rgba(0,206,201,0.3));
      border-radius:20px;z-index:-1;opacity:0.6;
    }
    .demo-box h2{
      font-size:2rem;margin-bottom:16px;color:#fff;font-weight:800;
    }
    .demo-box p{
      font-size:1.1rem;color:rgba(255,255,255,0.85);margin-bottom:24px;
    }
    .demo-preview{
      position:relative;border-radius:12px;overflow:hidden;
      background:#1a1a1d;margin-bottom:20px;
    }
    .demo-preview img{
      width:100%;height:auto;display:block;
      opacity:0;transition:opacity 0.5s;
    }
    .demo-preview img.loaded{opacity:1}
    .demo-skeleton{
      position:absolute;inset:0;
      background:linear-gradient(90deg, #2a2a2d 25%, #3a3a3d 50%, #2a2a2d 75%);
      background-size:200% 100%;
      animation:shimmer 1.5s infinite;
    }
    @keyframes shimmer{
      0%{background-position:200% 0}
      100%{background-position:-200% 0}
    }
    .demo-preview.loaded .demo-skeleton{display:none}
    .demo-actions{
      display:flex;gap:12px;justify-content:center;flex-wrap:wrap;
    }
    .demo-actions .btn{
      padding:12px 24px;border-radius:10px;font-weight:800; /* MODIFICA: Peso del font uniformato */
      font-size: 1rem; /* MODIFICA: Dimensione del font uniformata */
      text-decoration:none;transition:all 0.3s;
      cursor:pointer;
    }
    /* MODIFICA: Stile bottoni demo uniformato con gradiente */
    .demo-actions .btn-demo, .demo-actions .btn-secondary{
        background: var(--grad-primary);
        color: #fff;
        border: none;
    }
    .demo-actions .btn-demo:hover, .demo-actions .btn-secondary:hover {
        filter: brightness(1.1);
        transform: translateY(-2px);
    }
    /* Demo Simulator - Replica Dashboard */
    .demo-sim{
      display:none;margin-top:24px;padding:32px 24px;position:relative;
      background:linear-gradient(135deg, rgba(255,255,255,0.98) 0%, rgba(250,251,252,0.98) 100%);
      backdrop-filter:blur(20px);
      border:2px solid rgba(108,92,231,0.15);
      border-radius:20px;
      text-align:left;
      box-shadow:0 8px 24px rgba(0,0,0,0.08);
      position:relative;overflow:hidden;
    }
    .demo-close-btn{
      position:absolute;top:16px;right:16px;
      width:36px;height:36px;border-radius:50%;
      background:rgba(231,76,60,0.1);
      border:2px solid rgba(231,76,60,0.3);
      color:#e74c3c;font-size:1.3rem;
      cursor:pointer;display:flex;align-items:center;justify-content:center;
      transition:all 0.3s var(--ease-smooth);
      z-index:10;
    }
    .demo-close-btn:hover{
      background:rgba(231,76,60,0.15);
      border-color:#e74c3c;
      transform:scale(1.1) rotate(90deg);
    }
    .demo-sim.active{display:block;animation:fadeInUp 0.5s}
    @keyframes fadeInUp{
      from{opacity:0;transform:translateY(20px)}
      to{opacity:1;transform:translateY(0)}
    }
    .demo-sim h3{
      font-size:1.6rem;margin-bottom:20px;font-weight:800;
      background:linear-gradient(135deg,rgba(108,92,231,0.8),rgba(0,206,201,0.8));
      -webkit-background-clip:text;background-clip:text;color:transparent;
      text-shadow:none;
    }
    .demo-form{
      display:grid;grid-template-columns:1fr 1fr;gap:16px;
      margin-bottom:24px;
    }
    @media(max-width:768px){
      .demo-form{grid-template-columns:1fr}
    }
    .demo-form-group{
      display:flex;flex-direction:column;gap:6px;
    }
    .demo-form-group.full-width{
      grid-column:span 2;
    }
    @media(max-width:768px){
      .demo-form-group.full-width{grid-column:span 1}
    }
    .demo-form-group label{
      font-size:0.9rem;font-weight:700;color:#333;
      text-transform:uppercase;letter-spacing:0.3px;
    }
    .demo-form-group input,
    .demo-form-group select{
      padding:11px 14px;border-radius:8px;border:2px solid #ddd;
      background:#fff;color:#111;font-size:1rem;
      transition:all 0.2s;font-weight:500;
    }
    .demo-form-group input::placeholder{
      color:#999;
    }
    .demo-form-group input:focus,
    .demo-form-group select:focus{
      outline:none;border-color:#6c5ce7;
      box-shadow:0 0 0 3px rgba(108,92,231,0.1);
    }
    .demo-form-group select option{
      background:#fff;color:#111;
    }
    .demo-submit-btn{
      grid-column:span 2;padding:14px 24px;border-radius:12px;
      font-weight:800;
      background:linear-gradient(135deg,rgba(108,92,231,0.85),rgba(162,155,254,0.85));
      color:#fff;border:none;cursor:pointer;
      transition:all 0.3s var(--ease-smooth);
      font-size:1.05rem;
      box-shadow:0 4px 16px rgba(108,92,231,0.2);
      position:relative;overflow:hidden;
    }
    .demo-submit-btn:hover{
      background:linear-gradient(135deg,rgba(108,92,231,1),rgba(162,155,254,1));
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(108,92,231,0.3);
    }
    .demo-submit-btn span{
      position:relative;z-index:1;
    }
    @media(max-width:768px){
      .demo-submit-btn{grid-column:span 1}
    }
    .demo-submit-btn:hover{
      transform:translateY(-2px);filter:brightness(1.1);
    }
    .demo-results{
      margin-top:28px;padding-top:28px;
      border-top:1px solid var(--glass-border);
    }
    .demo-results h4{
      font-size:1.2rem;margin-bottom:16px;color:#111;font-weight:800;
    }
    .demo-summary{
      display:grid;grid-template-columns:1fr 1fr;gap:16px;
      margin-bottom:24px;
    }
    @media(max-width:768px){
      .demo-summary{grid-template-columns:1fr}
    }
    .demo-summary-card{
      padding:24px;background:#fff;border-radius:16px;
      border:2px solid #f0f0f0;
      box-shadow:0 2px 12px rgba(0,0,0,0.04);
      transition:all 0.3s var(--ease-smooth);
    }
    .demo-summary-card:hover{
      transform:translateY(-2px);
      box-shadow:0 4px 20px rgba(0,0,0,0.08);
      border-color:#e8e8e8;
    }
    .demo-summary-card h5{
      font-size:0.85rem;color:#888;
      margin:0 0 8px;font-weight:700;text-transform:uppercase;
      letter-spacing:0.8px;
    }
    .demo-summary-card .amount{
      font-size:2rem;font-weight:900;
    }
    .demo-summary-card.income .amount{
      color:#27ae60;
    }
    .demo-summary-card.expense .amount{
      color:#e74c3c;
    }
    
    /* Donut Chart */
    .demo-donut-wrapper{
      display:none;margin:24px auto;max-width:320px;
      text-align:center;
    }
    .demo-donut-wrapper.show{
      display:block;animation:scaleIn 0.6s var(--ease-bounce);
    }
    @keyframes scaleIn{
      0%{opacity:0;transform:scale(0.8)}
      100%{opacity:1;transform:scale(1)}
    }
    .demo-donut-title{
      font-size:1.1rem;font-weight:700;color:#333;
      margin-bottom:16px;text-align:center;
    }
    .demo-donut-chart{
      position:relative;width:240px;height:240px;margin:0 auto 20px;
    }
    .demo-donut-chart svg{
      transform:rotate(-90deg);filter:drop-shadow(0 4px 12px rgba(0,0,0,0.15));
    }
    .demo-donut-center{
      position:absolute;inset:0;display:flex;flex-direction:column;
      align-items:center;justify-content:center;
      pointer-events:none;
    }
    .demo-donut-center-label{
      font-size:0.85rem;color:#666;font-weight:600;
      text-transform:uppercase;letter-spacing:0.5px;
    }
    .demo-donut-center-value{
      font-size:2rem;font-weight:800;
      background:linear-gradient(135deg,#27ae60,#2ecc71);
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .demo-donut-legend{
      display:flex;gap:20px;justify-content:center;flex-wrap:wrap;
    }
    .demo-donut-legend-item{
      display:flex;align-items:center;gap:8px;
    }
    .demo-donut-legend-color{
      width:16px;height:16px;border-radius:4px;
    }
    .demo-donut-legend-color.income{
      background:linear-gradient(135deg,#27ae60,#2ecc71);
    }
    .demo-donut-legend-color.expense{
      background:linear-gradient(135deg,#e74c3c,#ec7063);
    }
    .demo-donut-legend-text{
      font-size:0.95rem;font-weight:600;color:#333;
    }
    .demo-categories{
      display:flex;flex-direction:column;gap:14px;
    }
    .demo-category-item{
      background:#fafafa;padding:20px;border-radius:14px;
      border:2px solid #f0f0f0;
      box-shadow:0 2px 8px rgba(0,0,0,0.03);
      transition:all 0.3s var(--ease-smooth);
    }
    .demo-category-item:hover{
      background:#fff;
      border-color:#e8e8e8;
      box-shadow:0 4px 16px rgba(0,0,0,0.06);
    }
    .demo-category-header{
      display:flex;justify-content:space-between;align-items:center;
      margin-bottom:12px;
    }
    .demo-category-name{
      font-size:1.05rem;font-weight:700;color:#333;
      display:flex;align-items:center;gap:8px;
    }
    .demo-category-total{
      font-size:1.2rem;font-weight:800;color:#e74c3c;
    }
    .demo-category-bar{
      width:100%;height:14px;background:#f5f5f5;
      border-radius:999px;overflow:hidden;
      box-shadow:inset 0 1px 2px rgba(0,0,0,0.05);
    }
    .demo-category-bar-fill{
      height:100%;
      background:linear-gradient(90deg,rgba(108,92,231,0.7),rgba(162,155,254,0.7));
      border-radius:999px;transition:width 0.6s var(--ease-smooth);
    }
    .demo-transactions-list{
      margin-top:20px;max-height:320px;overflow-y:auto;
      display:flex;flex-direction:column;gap:10px;
      padding-right:4px;
    }
    .demo-transaction-item{
      display:flex;justify-content:space-between;align-items:center;
      padding:14px 16px;background:#fafafa;
      border-radius:10px;border:1px solid #f0f0f0;
      transition:all 0.2s;
    }
    .demo-transaction-item:hover{
      background:#fff;
      border-color:#e8e8e8;
      box-shadow:0 2px 8px rgba(0,0,0,0.04);
    }
    .demo-transaction-info{
      display:flex;flex-direction:column;gap:4px;
    }
    .demo-transaction-note{
      font-size:1rem;font-weight:700;color:#111;
    }
    .demo-transaction-cat{
      font-size:0.85rem;color:#666;font-weight:500;
    }
    .demo-transaction-amount{
      font-size:1.15rem;font-weight:800;
    }
    .demo-transaction-item.income .demo-transaction-amount{
      color:#27ae60;
    }
    .demo-transaction-item.expense .demo-transaction-amount{
      color:#e74c3c;
    }

    /* ========== BENEFITS / HOW-TO (MODIFIED) ========== */
    .section{
      padding:60px 20px;
    }
    .section-title{
      font-size:2.5rem;font-weight:800;text-align:center;margin-bottom:40px;
      background:var(--grad-primary);
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .grid{
      display:grid;gap:24px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
    }
    /* MODIFICA: Stile .card uniformato a .price-card */
    .card{
      background:rgba(255, 255, 255, 0.8);
      backdrop-filter:blur(16px);
      border:1px solid rgba(0,0,0,.06);
      border-radius:16px;
      padding:28px;text-align:center;
      transition:all 0.3s var(--ease-smooth);
      box-shadow:0 10px 30px rgba(0,0,0,.10);
      position:relative;
      overflow:hidden;
    }
    .card::before{
      display: none;
    }
    .card:hover{
      transform:translateY(-6px);
      box-shadow:0 16px 40px rgba(0,0,0,0.15);
    }
    .card-emoji{
      font-size:4rem;margin-bottom:16px;
      display:block;
      animation:float 3s ease-in-out infinite;
      filter:drop-shadow(0 4px 12px rgba(0,0,0,0.15));
    }
    @keyframes float{
      0%,100%{transform:translateY(0px)}
      50%{transform:translateY(-10px)}
    }
    .card:hover .card-emoji{
      animation:bounce 0.6s ease;
    }
    @keyframes bounce{
      0%,100%{transform:scale(1)}
      50%{transform:scale(1.15)}
    }
    .card h3{
      font-size:1.5rem;margin-bottom:12px;
      color:#111; /* MODIFICA: Testo scuro */
      font-weight:800;
    }
    .card p{
      font-size:1rem;
      color:#333; /* MODIFICA: Testo scuro */
      line-height:1.6;
    }
    .howto-icon{
      width:64px;height:64px;margin:0 auto 16px;
      filter:drop-shadow(0 4px 12px rgba(0,0,0,0.2));
    }

    /* ========== PRICING (MODIFIED) ========== */
    .pricing-section{
      padding:60px 20px;
    }
    .pricing-grid{
      display:grid;gap:24px;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
      max-width:1100px;margin:0 auto;
    }
    .price-card{
      position:relative;
      background:rgba(255, 255, 255, 0.8);
      backdrop-filter:blur(16px);
      border:1px solid rgba(0,0,0,.06);
      border-radius:20px;
      padding:48px 32px 36px;text-align:center;
      transition:all 0.3s var(--ease-smooth);
      overflow:visible;
      box-shadow:0 10px 30px rgba(0,0,0,.10);
    }
    .price-card::before{
      content:'';
      display: none;
    }
    .price-card:hover{
      transform:translateY(-8px) scale(1.02);
      box-shadow:0 24px 60px rgba(0,0,0,0.15);
    }
    .price-card.popular{
      background:rgba(255, 255, 255, 0.95);
      outline:3px solid #6c5ce7;
      transform:scale(1.05);
    }
    .price-card.popular:hover{
      transform:translateY(-8px) scale(1.07);
    }
    .price-card-emoji{
      position:absolute;top:-30px;left:50%;transform:translateX(-50%);
      font-size:3.5rem;
      filter:drop-shadow(0 8px 16px rgba(0,0,0,0.3));
      z-index:10;
    }
    .price-card-emoji.rocket{
      animation:rocketFloat 2s ease-in-out infinite;
    }
    @keyframes rocketFloat{
      0%,100%{transform:translateX(-50%) translateY(0px) rotate(-5deg)}
      50%{transform:translateX(-50%) translateY(-8px) rotate(5deg)}
    }
    .price-card-emoji.stars{
      animation:starsSparkle 1.5s ease-in-out infinite;
    }
    @keyframes starsSparkle{
      0%,100%{transform:translateX(-50%) scale(1) rotate(0deg)}
      50%{transform:translateX(-50%) scale(1.15) rotate(5deg)}
    }
    .price-card-emoji.diamond{
      animation:diamondShine 2s ease-in-out infinite;
    }
    @keyframes diamondShine{
      0%,100%{transform:translateX(-50%) scale(1);filter:drop-shadow(0 8px 16px rgba(0,0,0,0.3)) brightness(1)}
      50%{transform:translateX(-50%) scale(1.1);filter:drop-shadow(0 8px 20px rgba(108,92,231,0.6)) brightness(1.3)}
    }
    .price-card .badge{
      position:absolute;top:14px; right:14px; font-size:.85rem;
      background:#6c5ce7; color:#fff; border-radius:999px; padding:4px 10px; font-weight:700;
      box-shadow:0 6px 18px rgba(108,92,231,.35);
      animation: none;
    }
    .plan-title{
      font-size:1.3rem;font-weight:800;margin-bottom:12px;color:#333;
      display:flex;flex-direction:column;gap:8px;
    }
    .plan-name{
      font-size:1.5rem;
      background:linear-gradient(135deg,#333,#555);
      -webkit-background-clip:text;background-clip:text;color:transparent;
      font-weight:900;
    }
    .plan-title .plan-name{display:block;margin-bottom:4px}
    .plan-title .price-inline{
      font-size:2.5rem;font-weight:900;
      background: var(--grad-primary);
      -webkit-background-clip:text;background-clip:text;color:transparent;
      display:block;margin-top:12px;
      text-shadow: none; filter: none; animation: none;
    }
    .price-card.popular .price-inline{
      font-size:2.8rem;
    }
    .plan-title .price-inline small{
      font-size:1.1rem;
      background:none;-webkit-background-clip:unset;
      background-clip:unset;color: #555;
      font-weight: 500;
    }
    .features{
      margin:20px 0;color:#333;
    }
    .features ul{list-style:none;padding:0}
    .features li{
      padding:6px 0;display:flex;align-items:center;justify-content:center;gap:8px;
    }
    .features li::before{
      content:"‚úì";color:#00cec9;font-weight:900;
    }
    .pricing-section .btn-secondary{
      display:inline-block;padding:14px 32px;border-radius:12px;
      background:var(--grad-primary);
      color:#fff;font-weight:800;font-size:1.05rem;
      text-decoration:none;transition:all 0.3s var(--ease-smooth);
      box-shadow:0 8px 24px rgba(0,0,0,0.14);
      position:relative;overflow:hidden;
    }
    .pricing-section .btn-secondary::before{
       content: ''; display: none;
    }
    .pricing-section .btn-secondary:hover{
      transform:translateY(-3px);
      box-shadow:0 12px 32px rgba(0,0,0,0.2);
      filter: brightness(1.1);
    }
    .pricing-section .btn-secondary:hover::before{
      opacity:0;
    }

    /* ========== TESTIMONIALS ========== */
    .testimonials-section{
      padding:60px 20px;
    }
    .testimonials-grid{
      display:grid;gap:24px;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
      max-width:1200px;margin:0 auto;
    }
    .testimonial-card{
      background:var(--glass-bg);backdrop-filter:blur(12px);
      border:2px solid transparent;
      background-clip:padding-box;
      border-radius:16px;
      padding:28px;
      transition:all 0.3s var(--ease-smooth);
      position:relative;overflow:hidden;
    }
    .testimonial-card::before{
      content:'';position:absolute;inset:-2px;
      background:linear-gradient(135deg,rgba(108,92,231,0.25),rgba(0,206,201,0.25));
      border-radius:16px;z-index:-1;
      transition:opacity 0.3s;opacity:0.4;
    }
    .testimonial-card:hover{
      transform:translateY(-4px);
      box-shadow:0 12px 32px rgba(0,0,0,0.15);
    }
    .testimonial-card:hover::before{
      opacity:0.7;
    }
    .testimonial-header{
      display:flex;align-items:center;gap:16px;
      margin-bottom:16px;
    }
    .testimonial-avatar{
      width:56px;height:56px;border-radius:50%;
      background:linear-gradient(135deg,#6c5ce7,#00cec9);
      display:flex;align-items:center;justify-content:center;
      font-size:1.5rem;font-weight:800;color:#fff;
      box-shadow:0 4px 12px rgba(108,92,231,0.3);
    }
    .testimonial-info{
      flex:1;
    }
    .testimonial-name{
      font-size:1.1rem;font-weight:800;color:#fff;
      margin-bottom:4px;
    }
    .testimonial-role{
      font-size:0.9rem;color:rgba(255,255,255,0.7);
    }
    .testimonial-stars{
      display:flex;gap:4px;margin-bottom:16px;
    }
    .testimonial-stars span{
      color:#ffd700;font-size:1.2rem;
      filter:drop-shadow(0 2px 4px rgba(255,215,0,0.3));
    }
    .testimonial-text{
      font-size:1rem;line-height:1.6;
      color:rgba(255,255,255,0.9);
      font-style:italic;
    }
    .testimonial-text::before{
      content:'"';font-size:2rem;color:rgba(108,92,231,0.3);
      line-height:0;position:relative;top:8px;margin-right:4px;
    }
    .testimonial-text::after{
      content:'"';font-size:2rem;color:rgba(108,92,231,0.3);
      line-height:0;position:relative;top:8px;margin-left:4px;
    }

    /* ========== LEAD MAGNET ========== */
    .lead-magnet{
      position:fixed;bottom:20px;right:20px;z-index:90;
      max-width:340px;
      background:var(--glass-bg);backdrop-filter:blur(16px);
      border:1px solid var(--glass-border);border-radius:16px;
      padding:24px;box-shadow:0 12px 32px rgba(0,0,0,0.3);
      animation:slideInRight 0.5s var(--ease-smooth);
    }
    @keyframes slideInRight{
      from{transform:translateX(400px);opacity:0}
      to{transform:translateX(0);opacity:1}
    }
    .lead-magnet.hidden{display:none}
    .lead-magnet h3{
      font-size:1.2rem;margin-bottom:8px;color:#fff;font-weight:800;
    }
    .lead-magnet p{
      font-size:0.95rem;color:rgba(255,255,255,0.85);margin-bottom:16px;
    }
    .lead-magnet form{
      display:flex;flex-direction:column;gap:10px;
    }
    .lead-magnet input{
      padding:10px;border-radius:8px;border:1px solid var(--glass-border);
      background:rgba(255,255,255,0.1);color:#fff;font-size:0.95rem;
    }
    .lead-magnet input::placeholder{color:rgba(255,255,255,0.5)}
    .lead-magnet button{
      padding:10px;border-radius:8px;font-weight:700;
      background:var(--grad-primary);color:#fff;border:none;cursor:pointer;
      transition:filter 0.2s;
    }
    .lead-magnet button:hover{filter:brightness(1.1)}
    .lead-magnet .close-lead{
      position:absolute;top:12px;right:12px;
      background:transparent;border:none;color:rgba(255,255,255,0.6);
      font-size:1.5rem;cursor:pointer;line-height:1;
      transition:color 0.2s;
    }
    .lead-magnet .close-lead:hover{color:#fff}
    @media(max-width:600px){
      .lead-magnet{bottom:10px;right:10px;left:10px;max-width:none}
    }

    /* ========== EXIT-INTENT MODAL ========== */
    .exit-modal-overlay{
      position:fixed;inset:0;z-index:200;
      background:rgba(0,0,0,0.8);backdrop-filter:blur(4px);
      display:none;align-items:center;justify-content:center;
      animation:fadeIn 0.3s;
    }
    @keyframes fadeIn{
      from{opacity:0}
      to{opacity:1}
    }
    .exit-modal-overlay.active{display:flex}
    .exit-modal{
      max-width:500px;width:90%;
      background:rgba(20,20,24,0.98);backdrop-filter:blur(20px);
      border:1px solid var(--glass-border);border-radius:20px;
      padding:40px;text-align:center;position:relative;
      animation:scaleIn 0.4s var(--ease-bounce);
    }
    @keyframes scaleIn{
      from{transform:scale(0.8);opacity:0}
      to{transform:scale(1);opacity:1}
    }
    .exit-modal h2{
      font-size:2rem;margin-bottom:12px;color:#fff;font-weight:800;
    }
    .exit-modal p{
      font-size:1.1rem;color:rgba(255,255,255,0.85);margin-bottom:24px;
      line-height:1.6;
    }
    .exit-modal .btn{
      padding:14px 32px;border-radius:12px;font-weight:800;font-size:1.05rem;
      text-decoration:none;display:inline-block;
      background:var(--grad-primary);color:#fff;
      transition:all 0.3s;
    }
    .exit-modal .btn:hover{
      transform:translateY(-2px);filter:brightness(1.1);
    }
    .exit-modal .close-modal{
      position:absolute;top:16px;right:16px;
      background:transparent;border:none;color:rgba(255,255,255,0.6);
      font-size:2rem;cursor:pointer;line-height:1;
      transition:color 0.2s;
    }
    .exit-modal .close-modal:hover{color:#fff}
    @media (prefers-reduced-motion:reduce){
      .exit-modal{animation:fadeIn 0.3s}
    }

    /* ========== FOOTER ========== */
    .footer{
      padding:40px 20px;text-align:center;
      border-top:1px solid var(--glass-border);
      color:rgba(255,255,255,0.7);font-size:0.95rem;
    }
    .footer a{
      color:#fff;text-decoration:none;transition:color 0.2s;
    }
    .footer a:hover{color:#00cec9}

    /* ========== REVEAL ANIMATION ========== */
    .reveal{
      opacity:0;transform:translateY(20px);
      transition:opacity 0.6s var(--ease-smooth), transform 0.6s var(--ease-smooth);
    }
    .reveal.visible{
      opacity:1;transform:translateY(0);
    }
    @media (prefers-reduced-motion:reduce){
      .reveal{opacity:1;transform:none;transition:none}
    }

    /* MODIFICA: Stili per il menu hamburger */
    .mobile-nav-toggle {
      display: none; /* Nascosto di default */
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      z-index: 101;
    }
    .hamburger-icon {
      display: block;
      width: 24px;
      height: 2px;
      background: #fff;
      position: relative;
      transition: background 0.2s;
    }
    .hamburger-icon::before,
    .hamburger-icon::after {
      content: '';
      position: absolute;
      width: 100%;
      height: 2px;
      background: #fff;
      left: 0;
      transition: transform 0.3s var(--ease-smooth);
    }
    .hamburger-icon::before { top: -8px; }
    .hamburger-icon::after { top: 8px; }
    
    /* MODIFICA: Stili per il menu a discesa mobile */
    .mobile-dropdown-menu {
      display: none;
      position: absolute;
      top: 100%; /* Appena sotto la topbar */
      left: 0;
      right: 0;
      background: var(--grad-primary);
      padding: 16px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
      border-bottom-left-radius: 12px;
      border-bottom-right-radius: 12px;
    }

    .mobile-dropdown-menu.is-open {
      display: block;
    }

    .mobile-dropdown-menu .links {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .mobile-dropdown-menu .links a {
      color: #fff;
      text-decoration: none;
      font-weight: 700;
      font-size: 1.1rem;
      padding: 12px;
      border-radius: 8px;
      background: rgba(255,255,255,0.1);
      text-align: center;
    }

    .mobile-dropdown-menu .links a:hover {
      background: rgba(255,255,255,0.2);
    }


    /* Modifiche per stato aperto icona hamburger */
    body.mobile-nav-is-open .hamburger-icon {
      background: transparent;
    }
    body.mobile-nav-is-open .hamburger-icon::before {
      transform: rotate(45deg) translate(5px, 6px);
    }
    body.mobile-nav-is-open .hamburger-icon::after {
      transform: rotate(-45deg) translate(5px, -6px);
    }

    /* ========== RESPONSIVE ========== */
    @media(max-width:600px){
      .topbar { position: relative; } /* Per posizionare il dropdown */
      .topbar-inner{padding:10px 16px; flex-wrap: nowrap; justify-content: space-between;}
      .topbar-actions { display: none; }
      .mobile-nav-toggle { display: block; }
      .hero-section{padding:80px 16px 40px}
      .section{padding:40px 16px}
      .sticky-cta-bar{flex-direction:column;gap:10px}
      .sticky-cta-bar .mini-headline{font-size:0.85rem}
    }
  </style>
</head>
<body>
  <!-- TOPBAR -->
  <nav class="topbar" aria-label="Navigazione principale">
    <div class="topbar-inner">
      <a href="/it/" class="logo-link" title="MyHomesBudget Home">
        <img src="/homes.png" alt="Logo MyHomesBudget" class="logo-image" loading="eager" width="36" height="36">
        <span class="logo-text">MyHomesBudget</span>
      </a>
      <div class="topbar-actions" id="topbar-actions">
        <!-- Login-aware content injected by JS -->
        <a class="top-link primary" href="/it/login.html">Accedi</a>
        <a class="top-link primary" href="/it/pricing.html">Prezzi</a>
        <span class="lang-selector" aria-label="Selettore lingua">
          <a href="/it/" title="Italiano" lang="it" aria-label="Italiano">üáÆüáπ</a>
          <a href="/en/" title="English" lang="en" aria-label="English">üá¨üáß</a>
          <a href="/es/" title="Espa√±ol" lang="es" aria-label="Espa√±ol">üá™üá∏</a>
        </span>
      </div>
      <!-- MODIFICA: Pulsante Hamburger per mobile -->
      <button class="mobile-nav-toggle" aria-label="Apri menu" aria-expanded="false">
        <span class="hamburger-icon"></span>
      </button>
    </div>
    <!-- MODIFICA: Menu a discesa mobile -->
    <div class="mobile-dropdown-menu" id="mobile-dropdown">
        <nav class="links">
            <a href="/it/login.html">Accedi</a>
            <a href="/it/pricing.html">Prezzi</a>
        </nav>
    </div>
  </nav>

  <!-- STICKY CTA BAR -->
  <div class="sticky-cta-bar" id="sticky-cta-bar" aria-hidden="true">
    <span class="mini-headline">Gestisci il tuo bilancio in modo semplice</span>
    <a href="/it/login.html" class="btn btn-primary" data-ga-label="login">Accedi</a>
    <a href="/it/pricing.html" class="btn btn-secondary" data-ga-label="pricing">Vedi i piani</a>
  </div>

  <main>
    <!-- HERO SECTION -->
    <section class="hero-section" id="hero-section">
      <div class="hero-orb" aria-hidden="true"></div>
      <div class="container">
        <!-- HERO HEADLINE A|B|C -->
        <div class="hero-content" id="hero-content">
          <!-- Content injected by JS based on ?v= param -->
        </div>
      </div>
    </section>

    <!-- TRUST ROW -->
    <section class="trust-row reveal">
      <div class="container">
        <div class="trust-pills">
          <div class="trust-pill">üö´ Senza pubblicit√†</div>
          <div class="trust-pill">üáÆüáπ Costruito in Italia</div>
          <div class="trust-pill">üîí Dati su provider affidabili</div>
        </div>
      </div>
    </section>

    <!-- DEMO-LIGHT -->
    <section class="demo-section reveal">
      <div class="container">
        <div class="demo-box">
          <h2>Vedi MyHomesBudget in azione</h2>
          <p>Un'anteprima della dashboard per gestire entrate, spese e obiettivi.</p>
          <div class="demo-preview" id="demo-preview">
            <div class="demo-skeleton"></div>
            <img src="/social.png" alt="Anteprima dashboard MyHomesBudget" loading="lazy" decoding="async" width="800" height="450">
          </div>
          <div class="demo-actions">
            <button class="btn btn-demo" id="btn-demo-flow">Prova DEMO</button>
            <a href="/it/login.html" class="btn btn-secondary">Inizia gratis</a>
          </div>
          <!-- Form simulatore demo -->
          <div class="demo-sim" id="demo-sim">
            <button class="demo-close-btn" id="demo-close-btn" aria-label="Chiudi demo" title="Chiudi demo">√ó</button>
            <h3>üí∞ Pannello Demo - Gestione Spese</h3>
            <form class="demo-form" id="demo-form">
              <div class="demo-form-group">
                <label for="demo-kind">Tipo</label>
                <select id="demo-kind" required>
                  <option value="expense">Uscita</option>
                  <option value="income">Entrata</option>
                </select>
              </div>
              <div class="demo-form-group">
                <label for="demo-amount">Importo (‚Ç¨)</label>
                <input type="number" id="demo-amount" placeholder="0.00" step="0.01" min="0.01" required>
              </div>
              <div class="demo-form-group full-width">
                <label for="demo-note">Nota</label>
                <input type="text" id="demo-note" placeholder="Es. Spesa supermercato, Stipendio..." required>
              </div>
              <div class="demo-form-group">
                <label for="demo-category">Categoria</label>
                <select id="demo-category" required>
                  <option value="">-- Seleziona --</option>
                </select>
              </div>
              <div class="demo-form-group">
                <label for="demo-subcategory">Sottocategoria</label>
                <select id="demo-subcategory">
                  <option value="">-- Seleziona --</option>
                </select>
              </div>
              <button type="submit" class="demo-submit-btn"><span>‚ú® Aggiungi operazione</span></button>
            </form>

            <!-- Risultati -->
            <div class="demo-results" id="demo-results" style="display:none;">
              <h4>üìä Riepilogo</h4>
              <div class="demo-summary">
                <div class="demo-summary-card income">
                  <h5>Entrate</h5>
                  <div class="amount" id="demo-total-income">‚Ç¨0.00</div>
                </div>
                <div class="demo-summary-card expense">
                  <h5>Uscite</h5>
                  <div class="amount" id="demo-total-expense">‚Ç¨0.00</div>
                </div>
              </div>
              
              <!-- Donut Chart (shown when both income and expense exist) -->
              <div class="demo-donut-wrapper" id="demo-donut-wrapper">
                <h4 class="demo-donut-title">üí∞ Bilancio Visuale</h4>
                <div class="demo-donut-chart">
                  <svg width="240" height="240" viewBox="0 0 240 240">
                    <circle cx="120" cy="120" r="90" fill="none" stroke="#f0f0f0" stroke-width="40"/>
                    <circle id="demo-donut-income" cx="120" cy="120" r="90" fill="none" 
                            stroke="url(#grad-income)" stroke-width="40"
                            stroke-dasharray="0 565.48" stroke-linecap="round"/>
                    <circle id="demo-donut-expense" cx="120" cy="120" r="90" fill="none" 
                            stroke="url(#grad-expense)" stroke-width="40"
                            stroke-dasharray="0 565.48" stroke-linecap="round"/>
                    <defs>
                      <linearGradient id="grad-income" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#27ae60"/>
                        <stop offset="100%" stop-color="#2ecc71"/>
                      </linearGradient>
                      <linearGradient id="grad-expense" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#e74c3c"/>
                        <stop offset="100%" stop-color="#ec7063"/>
                      </linearGradient>
                    </defs>
                  </svg>
                  <div class="demo-donut-center">
                    <div class="demo-donut-center-label">Saldo</div>
                    <div class="demo-donut-center-value" id="demo-donut-balance">‚Ç¨0</div>
                  </div>
                </div>
                <div class="demo-donut-legend">
                  <div class="demo-donut-legend-item">
                    <div class="demo-donut-legend-color income"></div>
                    <span class="demo-donut-legend-text">Entrate</span>
                  </div>
                  <div class="demo-donut-legend-item">
                    <div class="demo-donut-legend-color expense"></div>
                    <span class="demo-donut-legend-text">Uscite</span>
                  </div>
                </div>
              </div>
              
              <h4 style="margin-top:24px;">üìà Per Categoria</h4>
              <div class="demo-categories" id="demo-categories"></div>

              <h4 style="margin-top:24px;">üìù Ultime Operazioni</h4>
              <div class="demo-transactions-list" id="demo-transactions-list"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- BENEFITS -->
    <section class="section reveal">
      <div class="container">
        <h2 class="section-title">Perch√© scegliere MyHomesBudget</h2>
        <div class="grid">
          <div class="card">
            <span class="card-emoji" role="img" aria-label="Semplice">‚ú®</span>
            <h3>Zero complicazioni</h3>
            <p>Niente fogli di calcolo. Tutto chiaro e rapido, gestisci il tuo bilancio in pochi click.</p>
          </div>
          <div class="card">
            <span class="card-emoji" role="img" aria-label="Multi-dispositivo">üì±</span>
            <h3>Sempre con te</h3>
            <p>iPhone, Android e PC. Accedi ovunque, i tuoi dati sempre sincronizzati.</p>
          </div>
          <div class="card">
            <span class="card-emoji" role="img" aria-label="Privacy">üîí</span>
            <h3>Privacy UE</h3>
            <p>I tuoi dati sono in Europa e sotto il tuo controllo, nel rispetto del GDPR.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- HOW-TO -->
    <section class="section reveal">
      <div class="container">
        <h2 class="section-title">Inizia in 3 semplici passi</h2>
        <div class="grid">
          <div class="card">
            <div class="howto-icon" aria-hidden="true">
              <svg viewBox="0 0 64 64" width="64" height="64" fill="none">
                <defs>
                  <linearGradient id="grad-user" x1="0" y1="0" x2="1" y2="1">
                    <stop offset="0" stop-color="#6c5ce7"/>
                    <stop offset="1" stop-color="#00cec9"/>
                  </linearGradient>
                </defs>
                <circle cx="32" cy="22" r="10" fill="url(#grad-user)"/>
                <path d="M10 54c0-10 10-18 22-18s22 8 22 18" fill="none" stroke="url(#grad-user)" stroke-width="4" stroke-linecap="round"/>
              </svg>
            </div>
            <h3>Crea il tuo account</h3>
            <p>Registrati gratis in 30 secondi con la tua email o account Google.</p>
          </div>
          <div class="card">
            <div class="howto-icon" aria-hidden="true">
              <svg viewBox="0 0 64 64" width="64" height="64" fill="none">
                <defs>
                  <linearGradient id="grad-plus" x1="0" y1="0" x2="1" y2="1">
                    <stop offset="0" stop-color="#6c5ce7"/>
                    <stop offset="1" stop-color="#00cec9"/>
                  </linearGradient>
                </defs>
                <path d="M32 12v40M12 32h40" stroke="url(#grad-plus)" stroke-width="6" stroke-linecap="round"/>
              </svg>
            </div>
            <h3>Aggiungi le operazioni</h3>
            <p>Inserisci entrate e uscite con categorie personalizzate in pochi click.</p>
          </div>
          <div class="card">
            <div class="howto-icon" aria-hidden="true">
              <svg viewBox="0 0 64 64" width="64" height="64" fill="none">
                <defs>
                  <linearGradient id="grad-chart" x1="0" y1="0" x2="1" y2="1">
                    <stop offset="0" stop-color="#6c5ce7"/>
                    <stop offset="1" stop-color="#00cec9"/>
                  </linearGradient>
                </defs>
                <path d="M8 50h48M16 50V38M28 50V28M40 50V20M52 50V12" stroke="url(#grad-chart)" stroke-width="5" stroke-linecap="round"/>
              </svg>
            </div>
            <h3>Raggiungi i tuoi obiettivi</h3>
            <p>Monitora i progressi con grafici intuitivi e resta sempre nel tuo budget.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- PRICING -->
    <section class="pricing-section reveal">
      <div class="container">
        <h2 class="section-title">Un piano adatto ad ogni esigenza</h2>
        <div class="pricing-grid">
          <!-- Starter -->
          <div class="price-card">
            <div class="price-card-emoji rocket" role="img" aria-label="Razzo">üöÄ</div>
            <h4 class="plan-title">
              <span class="plan-name">Starter</span>
              <span class="price-inline">Gratis <small>/ 30 giorni</small></span>
            </h4>
            <div class="features">
              <ul>
                <li>Budget e obiettivi personali</li>
                <li>Categorie e sottocategorie personalizzate</li>
                <li>Report base mensili</li>
              </ul>
            </div>
            <a class="btn-secondary" href="signup.html?plan=starter"
               onclick="if(typeof gtag==='function')gtag('event','select_pricing',{plan:'starter',placement:'pricing_grid'});">
              Avvia la prova
            </a>
          </div>

          <!-- Plus (Popular) -->
          <div class="price-card popular">
            <div class="badge">Pi√π scelto</div>
            <div class="price-card-emoji stars" role="img" aria-label="Stelle">‚≠ê</div>
            <h4 class="plan-title">
              <span class="plan-name">Plus</span>
              <span class="price-inline">2,99‚Ç¨ <small>/ mese</small></span>
            </h4>
            <div class="features">
              <ul>
                <li>Tutto di Starter</li>
                <li>Report dettagliati e filtri avanzati</li>
                <li>Supporto prioritario via email</li>
              </ul>
            </div>
            <a class="btn-secondary" href="/it/paywall.html?plan=plus"
               onclick="if(typeof gtag==='function')gtag('event','select_pricing',{plan:'plus',placement:'pricing_grid'});">
              Passa a Plus
            </a>
          </div>

          <!-- Pro -->
          <div class="price-card">
            <div class="price-card-emoji diamond" role="img" aria-label="Diamante">üíé</div>
            <h4 class="plan-title">
              <span class="plan-name">Pro</span>
              <span class="price-inline">4,99‚Ç¨ <small>/ mese</small></span>
            </h4>
            <div class="features">
              <ul>
                <li>Tutto di Plus</li>
                <li>Obiettivi multipli</li>
                <li>Accesso multi-dispositivo senza limiti</li>
              </ul>
            </div>
            <a class="btn-secondary" href="/it/paywall.html?plan=pro"
               onclick="if(typeof gtag==='function')gtag('event','select_pricing',{plan:'pro',placement:'pricing_grid'});">
              Passa a Pro
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- TESTIMONIALS / RECENSIONI -->
    <section class="testimonials-section reveal">
      <div class="container">
        <h2 class="section-title">Cosa dicono i nostri utenti</h2>
        <div class="testimonials-grid">
          <div class="testimonial-card">
            <div class="testimonial-header">
              <div class="testimonial-avatar">MR</div>
              <div class="testimonial-info">
                <div class="testimonial-name">Marco Rossi</div>
                <div class="testimonial-role">Freelance ‚Ä¢ Milano</div>
              </div>
            </div>
            <div class="testimonial-stars" aria-label="5 stelle su 5">
              <span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span>
            </div>
            <p class="testimonial-text">
              Finalmente ho il controllo delle mie finanze! Prima usavo fogli Excel complicati, ora con MyHomesBudget tutto √® chiaro e rapido. Lo consiglio a tutti.
            </p>
          </div>

          <div class="testimonial-card">
            <div class="testimonial-header">
              <div class="testimonial-avatar">SB</div>
              <div class="testimonial-info">
                <div class="testimonial-name">Sara Bianchi</div>
                <div class="testimonial-role">Insegnante ‚Ä¢ Roma</div>
              </div>
            </div>
            <div class="testimonial-stars" aria-label="5 stelle su 5">
              <span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span>
            </div>
            <p class="testimonial-text">
              App perfetta per la gestione familiare! Riesco a monitorare tutte le spese e risparmio davvero. L'interfaccia √® intuitiva anche per chi non √® esperto.
            </p>
          </div>

          <div class="testimonial-card">
            <div class="testimonial-header">
              <div class="testimonial-avatar">LF</div>
              <div class="testimonial-info">
                <div class="testimonial-name">Luca Ferrari</div>
                <div class="testimonial-role">Impiegato ‚Ä¢ Torino</div>
              </div>
            </div>
            <div class="testimonial-stars" aria-label="5 stelle su 5">
              <span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span>
            </div>
            <p class="testimonial-text">
              Uso MyHomesBudget da 3 mesi e ho gi√† risparmiato il 20% sulle spese mensili. Vedere i grafici mi ha fatto capire dove sprecavo denaro. Fantastico!
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
      <div class="container">
        ¬© 2025 MyHomesBudget ‚Äî
        <a href="/it/pricing.html" onclick="if(typeof gtag==='function')gtag('event','cta_click',{placement:'footer_pricing',lang:'it'});">Piani &amp; Prezzi</a> ¬∑
        <a href="/it/privacy.html" rel="noopener">Privacy</a> ¬∑
        <a href="/it/terms.html" rel="noopener">Termini</a>
      </div>
    </footer>
  </main>

  <!-- LEAD MAGNET (only for non-logged users) -->
  <aside class="lead-magnet hidden" id="lead-magnet" role="complementary" aria-labelledby="lead-magnet-title">
    <button class="close-lead" aria-label="Chiudi" id="close-lead">&times;</button>
    <h3 id="lead-magnet-title">üì• Budget Starter Kit gratuito</h3>
    <p>Ricevi una guida PDF per iniziare a gestire il tuo bilancio familiare.</p>
    <form id="lead-form">
      <input type="email" placeholder="La tua email" required aria-label="Email">
      <button type="submit">Invia</button>
    </form>
  </aside>

  <!-- EXIT-INTENT MODAL (desktop only, non-logged) -->
  <div class="exit-modal-overlay" id="exit-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="exit-modal-title">
    <div class="exit-modal">
      <button class="close-modal" aria-label="Chiudi" id="close-exit-modal">&times;</button>
      <h2 id="exit-modal-title">Aspetta! üéØ</h2>
      <p>Non perdere l'opportunit√† di gestire il tuo bilancio in modo semplice. Prova MyHomesBudget gratis per 30 giorni, senza carta di credito.</p>
      <a href="/it/login.html" class="btn">Prova ora gratis</a>
    </div>
  </div>

  <!-- MAIN SCRIPT -->
  <script id="mhb-landing-enhance">
(function(){
  'use strict';

  // ====== UTILS ======
  const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  const isMobile = window.innerWidth < 900;
  const isDesktop = !isMobile;

  // Perf mobile: evita background fixed (paint costoso) sotto 900px
  (function injectMobilePerfCSS(){
    if (!isMobile) return;
    const st = document.createElement('style');
    st.textContent = '@media(max-width:900px){body{background-attachment:scroll!important;background-position:center top!important}}';
    document.head.appendChild(st);
  })();

  function safeGtag(eventName, params) {
    try{ if (typeof gtag === 'function') gtag('event', eventName, params); }catch(_){}
  }

  // ====== LOGIN AWARENESS ======
  function getUser() {
    try {
      const mhbUser = localStorage.getItem('mhb_user');
      if (mhbUser) return JSON.parse(mhbUser);

      // Fallback: sessione Supabase
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && key.includes('supabase.auth')) {
          try {
            const data = JSON.parse(localStorage.getItem(key));
            if (data && (data.user || data.currentSession?.user)) {
              const u = data.user || data.currentSession.user;
              return { name: u.user_metadata?.full_name || (u.email?.split('@')[0]) || 'Utente', email: u.email };
            }
          } catch(e){}
        }
      }
    } catch(e){}
    return null;
  }

  function logout() {
    try {
      localStorage.removeItem('mhb_user');
      // pulizia chiavi supabase
      for (let i = localStorage.length - 1; i >= 0; i--) {
        const k = localStorage.key(i);
        if (k && k.includes('supabase')) localStorage.removeItem(k);
      }
    } catch(e){}
    window.location.href = '/it/login.html';
  }

  const user = getUser();
  const isLoggedIn = !!user;

  // Update topbar (aggiungo Riepilogo e mantengo Prezzi quando loggato)
  const topbarActions = document.getElementById('topbar-actions');
  if (topbarActions) {
    if (isLoggedIn) {
      topbarActions.innerHTML = `
        <a class="top-link" href="/it/dashboard.html">Riepilogo</a>
        <a class="top-link" href="/it/pricing.html">Prezzi</a>
        <span class="user-greeting">Ciao, <strong>${user.name}</strong></span>
        <button class="btn-logout" id="btn-logout">Esci</button>
        <span class="lang-selector" aria-label="Selettore lingua">
          <a href="/it/" title="Italiano" lang="it" aria-label="Italiano">üáÆüáπ</a>
          <a href="/en/" title="English" lang="en" aria-label="English">üá¨üáß</a>
          <a href="/es/" title="Espa√±ol" lang="es" aria-label="Espa√±ol">üá™üá∏</a>
        </span>
      `;
      const btnLogout = document.getElementById('btn-logout');
      if (btnLogout) btnLogout.addEventListener('click', logout);
    }
  }

  // ====== HERO A/B VARIANT + HEADLINE ROTATOR ======
  const urlParams = new URLSearchParams(window.location.search);
  const variant = urlParams.get('v') === '2' ? 'v2' : 'v1';

  // MODIFICA: Corrette le frasi per la rotazione del titolo
  const rotatingParts = [
    'il tuo bilancio domestico',
    'le tue entrate e spese',
    'i tuoi obiettivi finanziari'
  ];
  let currentHeadlineIndex = 0;
  let headlineTimer = null;

  function rotateHeadline() {
    const rotatingEl = document.querySelector('.headline-rotating');
    if (!rotatingEl || prefersReducedMotion) return;
    rotatingEl.style.transition = 'opacity 0.5s';
    rotatingEl.style.opacity = '0';
    setTimeout(() => {
      currentHeadlineIndex = (currentHeadlineIndex + 1) % rotatingParts.length;
      rotatingEl.textContent = rotatingParts[currentHeadlineIndex];
      rotatingEl.style.opacity = '1';
    }, 500);
  }
  
  function startHeadlineRotate(){
    if (prefersReducedMotion || headlineTimer) return;
    headlineTimer = setInterval(rotateHeadline, 7000);
  }
  
  function stopHeadlineRotate(){
    if (!headlineTimer) return;
    clearInterval(headlineTimer);
    headlineTimer = null;
  }

  const heroContent = document.getElementById('hero-content');
  if (heroContent) {
    // MODIFICA: Aggiornata la struttura del titolo per la nuova animazione
    const heroHeadlineHTML = `Gestisci <span class="headline-rotating">${rotatingParts[0]}</span> in modo semplice`;

    if (variant === 'v2') {
      heroContent.className = 'hero-content hero-v2';
      heroContent.innerHTML = `
        <div class="hero-mockup">
          <img src="/social.png" alt="Dashboard MyHomesBudget" loading="eager" width="700" height="394">
        </div>
        <h1>${heroHeadlineHTML}</h1>
        <p>Inserisci le tue spese e le entrate in pochi click e tieni tutto sotto controllo.</p>
        <div class="hero-cta-row">
          <a href="/it/login.html" class="btn btn-primary" data-variant="v2">Accedi</a>
          <a href="/it/pricing.html" class="btn btn-secondary" data-variant="v2">Vedi i piani</a>
        </div>
      `;
    } else {
      heroContent.className = 'hero-content hero-v1';
      heroContent.innerHTML = `
        <div class="hero-text">
          <h1>${heroHeadlineHTML}</h1>
          <p>Inserisci le tue spese e le entrate in pochi click e tieni tutto sotto controllo.</p>
          <div class="hero-cta-row">
            <a href="/it/login.html" class="btn btn-primary" data-variant="v1">Accedi</a>
            <a href="/it/pricing.html" class="btn btn-secondary" data-variant="v1">Vedi i piani</a>
          </div>
        </div>
        <div class="hero-mockup">
          <img src="/social.png" alt="Dashboard MyHomesBudget" loading="eager" width="600" height="338">
        </div>
      `;
    }

    // GA4 tracking for hero CTAs
    heroContent.querySelectorAll('.btn').forEach(btn => {
      btn.addEventListener('click', () => safeGtag('cta_hero_click', { label: btn.dataset.variant || 'v1' }));
    });

    if (!prefersReducedMotion) {
      startHeadlineRotate();
      heroContent.addEventListener('mouseenter', stopHeadlineRotate);
      heroContent.addEventListener('mouseleave', startHeadlineRotate);
    }
  }

  // ====== PARALLAX (orb) ======
  if (!prefersReducedMotion && !isMobile) {
    const heroSection = document.getElementById('hero-section');
    const heroOrb = document.querySelector('.hero-orb');
    if (heroSection && heroOrb) {
      heroSection.addEventListener('mousemove', (e) => {
        requestAnimationFrame(() => {
          const rect = heroSection.getBoundingClientRect();
          const x = (e.clientX - rect.left) / rect.width - 0.5;
          const y = (e.clientY - rect.top) / rect.height - 0.5;
          heroOrb.style.transform = `translate(${x * 30}px, ${y * 30}px)`;
        });
      });
    }
  }

  // ====== REVEAL ANIMATION ======
  const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' };
  const revealObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        revealObserver.unobserve(entry.target);
      }
    });
  }, observerOptions);
  document.querySelectorAll('.reveal').forEach(el => {
    if (!prefersReducedMotion) revealObserver.observe(el); else el.classList.add('visible');
  });

  // ====== STICKY CTA BAR ======
  const stickyCta = document.getElementById('sticky-cta-bar');
  function updateStickyCta() {
    const scrollPercent = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
    if (scrollPercent > 40 && scrollPercent < 95) {
      stickyCta.classList.add('visible');
      stickyCta.setAttribute('aria-hidden', 'false');
    } else {
      stickyCta.classList.remove('visible');
      stickyCta.setAttribute('aria-hidden', 'true');
    }
  }
  updateStickyCta();
  let ticking = false;
  window.addEventListener('scroll', () => {
    if (!ticking) {
      requestAnimationFrame(() => { updateStickyCta(); ticking = false; });
      ticking = true;
    }
  }, { passive: true });

  stickyCta.querySelectorAll('.btn').forEach(btn => {
    btn.addEventListener('click', () => safeGtag('cta_sticky_click', { label: btn.dataset.gaLabel }));
  });

  // ====== DEMO-LIGHT ======
  const demoPreview = document.getElementById('demo-preview');
  const demoImg = demoPreview?.querySelector('img');
  if (demoImg) {
    const onLoad = () => { demoImg.classList.add('loaded'); demoPreview.classList.add('loaded'); };
    demoImg.addEventListener('load', onLoad);
    if (demoImg.complete) onLoad();
  }

  const btnDemo = document.getElementById('btn-demo-flow');
  const demoSim = document.getElementById('demo-sim');
  const demoForm = document.getElementById('demo-form');
  const demoResults = document.getElementById('demo-results');
  
  // Categorie e sottocategorie dummy
  const demoCategories = {
    expense: [
      { id: 'casa', name: 'üè† Casa', subs: ['Affitto', 'Bollette', 'Manutenzione'] },
      { id: 'alimentari', name: 'üõí Alimentari', subs: ['Supermercato', 'Ristoranti', 'Caff√®'] },
      { id: 'trasporti', name: 'üöó Trasporti', subs: ['Benzina', 'Mezzi pubblici', 'Parcheggio'] },
      { id: 'salute', name: 'üíä Salute', subs: ['Medico', 'Farmacia', 'Palestra'] },
      { id: 'svago', name: 'üé¨ Svago', subs: ['Cinema', 'Libri', 'Hobby'] }
    ],
    income: [
      { id: 'stipendio', name: 'üíº Stipendio', subs: [] },
      { id: 'freelance', name: 'üíª Freelance', subs: [] },
      { id: 'altro', name: 'üí∞ Altro', subs: [] }
    ]
  };

  let demoTransactions = [];
  let demoCategoryTotals = {};

  // Popola select categorie
  function populateDemoCategories(kind) {
    const catSelect = document.getElementById('demo-category');
    const subSelect = document.getElementById('demo-subcategory');
    catSelect.innerHTML = '<option value="">-- Seleziona --</option>';
    subSelect.innerHTML = '<option value="">-- Seleziona --</option>';
    
    const cats = demoCategories[kind] || [];
    cats.forEach(cat => {
      const opt = document.createElement('option');
      opt.value = cat.id;
      opt.textContent = cat.name;
      opt.dataset.subs = JSON.stringify(cat.subs);
      catSelect.appendChild(opt);
    });
  }

  // Aggiorna sottocategorie
  function updateDemoSubcategories() {
    const catSelect = document.getElementById('demo-category');
    const subSelect = document.getElementById('demo-subcategory');
    const selectedOpt = catSelect.options[catSelect.selectedIndex];
    
    subSelect.innerHTML = '<option value="">-- Nessuna --</option>';
    if (selectedOpt && selectedOpt.dataset.subs) {
      const subs = JSON.parse(selectedOpt.dataset.subs);
      subs.forEach(sub => {
        const opt = document.createElement('option');
        opt.value = sub;
        opt.textContent = sub;
        subSelect.appendChild(opt);
      });
    }
  }

  if (btnDemo) {
    btnDemo.addEventListener('click', () => {
      demoSim.classList.add('active');
      btnDemo.style.display = 'none';
      populateDemoCategories('expense');
    });
  }

  // Close demo button
  const demoCloseBtn = document.getElementById('demo-close-btn');
  if (demoCloseBtn) {
    demoCloseBtn.addEventListener('click', () => {
      demoSim.classList.remove('active');
      btnDemo.style.display = '';
      // Reset demo
      demoTransactions = [];
      demoCategoryTotals = {};
      demoForm.reset();
      demoResults.style.display = 'none';
    });
  }

  if (demoForm) {
    document.getElementById('demo-kind').addEventListener('change', (e) => {
      populateDemoCategories(e.target.value);
    });

    document.getElementById('demo-category').addEventListener('change', updateDemoSubcategories);

    demoForm.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const kind = document.getElementById('demo-kind').value;
      const amount = parseFloat(document.getElementById('demo-amount').value) || 0;
      const note = document.getElementById('demo-note').value;
      const catId = document.getElementById('demo-category').value;
      const catText = document.getElementById('demo-category').options[document.getElementById('demo-category').selectedIndex].text;
      const subText = document.getElementById('demo-subcategory').value || '';

      if (!catId || amount <= 0) return;

      // Aggiungi transazione
      demoTransactions.unshift({
        kind, amount, note, catId, catText, subText, 
        date: new Date().toLocaleDateString('it-IT')
      });

      // Aggiorna totali per categoria
      const key = `${kind}-${catId}`;
      if (!demoCategoryTotals[key]) {
        demoCategoryTotals[key] = { kind, catId, catText, total: 0 };
      }
      demoCategoryTotals[key].total += amount;

      // Reset form
      demoForm.reset();
      document.getElementById('demo-kind').value = kind;
      populateDemoCategories(kind);

      // Mostra risultati
      renderDemoResults();
    });
  }

  function renderDemoResults() {
    demoResults.style.display = 'block';

    // Calcola totali
    let totalIncome = 0, totalExpense = 0;
    demoTransactions.forEach(t => {
      if (t.kind === 'income') totalIncome += t.amount;
      else totalExpense += t.amount;
    });

    document.getElementById('demo-total-income').textContent = `‚Ç¨${totalIncome.toFixed(2)}`;
    document.getElementById('demo-total-expense').textContent = `‚Ç¨${totalExpense.toFixed(2)}`;

    // Render Donut Chart (only if both income and expense exist)
    const donutWrapper = document.getElementById('demo-donut-wrapper');
    if (totalIncome > 0 && totalExpense > 0) {
      const total = totalIncome + totalExpense;
      const incomePercent = (totalIncome / total) * 100;
      const expensePercent = (totalExpense / total) * 100;
      const circumference = 2 * Math.PI * 90; // r=90
      
      const incomeArc = (incomePercent / 100) * circumference;
      const expenseArc = (expensePercent / 100) * circumference;
      
      const incomeCircle = document.getElementById('demo-donut-income');
      const expenseCircle = document.getElementById('demo-donut-expense');
      
      // Income (starts at 0)
      incomeCircle.style.strokeDasharray = `${incomeArc} ${circumference}`;
      incomeCircle.style.strokeDashoffset = '0';
      
      // Expense (starts after income)
      expenseCircle.style.strokeDasharray = `${expenseArc} ${circumference}`;
      expenseCircle.style.strokeDashoffset = `-${incomeArc}`;
      
      // Balance
      const balance = totalIncome - totalExpense;
      const balanceEl = document.getElementById('demo-donut-balance');
      balanceEl.textContent = `‚Ç¨${Math.abs(balance).toFixed(2)}`;
      balanceEl.style.background = balance >= 0 
        ? 'linear-gradient(135deg,#27ae60,#2ecc71)' 
        : 'linear-gradient(135deg,#e74c3c,#ec7063)';
      balanceEl.style.webkitBackgroundClip = 'text';
      balanceEl.style.backgroundClip = 'text';
      balanceEl.style.color = 'transparent';
      
      donutWrapper.classList.add('show');
    } else {
      donutWrapper.classList.remove('show');
    }

    // Render categorie
    const categoriesDiv = document.getElementById('demo-categories');
    categoriesDiv.innerHTML = '';

    const maxTotal = Math.max(...Object.values(demoCategoryTotals).map(c => c.total), 1);
    
    Object.values(demoCategoryTotals).forEach(cat => {
      const percent = (cat.total / maxTotal) * 100;
      const div = document.createElement('div');
      div.className = 'demo-category-item';
      div.innerHTML = `
        <div class="demo-category-header">
          <div class="demo-category-name">${cat.catText}</div>
          <div class="demo-category-total">‚Ç¨${cat.total.toFixed(2)}</div>
        </div>
        <div class="demo-category-bar">
          <div class="demo-category-bar-fill" style="width:${percent}%"></div>
        </div>
      `;
      categoriesDiv.appendChild(div);
    });

    // Render transazioni (max 5)
    const transactionsDiv = document.getElementById('demo-transactions-list');
    transactionsDiv.innerHTML = '';
    demoTransactions.slice(0, 5).forEach(t => {
      const div = document.createElement('div');
      div.className = `demo-transaction-item ${t.kind}`;
      div.innerHTML = `
        <div class="demo-transaction-info">
          <div class="demo-transaction-note">${t.note}</div>
          <div class="demo-transaction-cat">${t.catText}${t.subText ? ' ‚Ä¢ ' + t.subText : ''}</div>
        </div>
        <div class="demo-transaction-amount">${t.kind === 'income' ? '+' : '-'}‚Ç¨${t.amount.toFixed(2)}</div>
      `;
      transactionsDiv.appendChild(div);
    });
  }

  // ====== LEAD MAGNET ======
  if (!isLoggedIn) {
    const leadMagnet = document.getElementById('lead-magnet');
    const closeLead = document.getElementById('close-lead');
    const leadForm = document.getElementById('lead-form');

    try {
      const leadShown = sessionStorage.getItem('mhb_lead_shown');
      const leadDismissed = localStorage.getItem('mhb_lead_dismissed');
      if (!leadShown && !leadDismissed) {
        setTimeout(() => {
          leadMagnet.classList.remove('hidden');
          sessionStorage.setItem('mhb_lead_shown', '1');
        }, 8000);
      }
    } catch(e){}

    if (closeLead) {
      closeLead.addEventListener('click', () => {
        leadMagnet.classList.add('hidden');
        try { localStorage.setItem('mhb_lead_dismissed','1'); } catch(e){}
      });
    }

    if (leadForm) {
      leadForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const email = leadForm.querySelector('input[type="email"]').value;
        safeGtag('lead_submit', { email_domain: (email.split('@')[1] || 'unknown') });
        leadMagnet.innerHTML = '<p style="text-align:center;padding:40px 20px;color:#fff;">‚úÖ Grazie! Controlla la tua email.</p>';
        setTimeout(() => {
          leadMagnet.classList.add('hidden');
          try { localStorage.setItem('mhb_lead_dismissed','1'); } catch(e){}
        }, 3000);
      });
    }
  }

  // ====== EXIT-INTENT MODAL (con focus-trap & restore) ======
  if (!isLoggedIn && isDesktop) {
    const exitOverlay = document.getElementById('exit-modal-overlay');
    const closeExitModal = document.getElementById('close-exit-modal');
    const dialog = exitOverlay?.querySelector('.exit-modal');
    let exitShown = false, lastFocused = null;

    try { exitShown = sessionStorage.getItem('mhb_exit_shown') === '1'; } catch(e){}

    const FOCUS_SELECTOR = 'a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])';

    function showExitModal() {
      if (exitShown) return;
      lastFocused = document.activeElement;
      exitOverlay.classList.add('active');
      exitShown = true;
      try { sessionStorage.setItem('mhb_exit_shown','1'); } catch(e){}
      safeGtag('exit_intent_open',{});

      // focus trap
      const focusable = Array.from(dialog.querySelectorAll(FOCUS_SELECTOR));
      const first = focusable[0], last = focusable[focusable.length - 1];
      if (first) first.focus();

      function onKeydown(e){
        if (e.key === 'Escape') { e.preventDefault(); closeModal(); return; }
        if (e.key === 'Tab' && focusable.length) {
          if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
          else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
        }
      }
      exitOverlay.addEventListener('keydown', onKeydown);
      exitOverlay._trap = onKeydown;
    }

    function closeModal() {
      exitOverlay.classList.remove('active');
      if (exitOverlay._trap) exitOverlay.removeEventListener('keydown', exitOverlay._trap);
      if (lastFocused && typeof lastFocused.focus === 'function') lastFocused.focus();
    }

    document.addEventListener('mouseleave', (e) => { if (e.clientY < 10 && !exitShown) showExitModal(); });
    if (closeExitModal) closeExitModal.addEventListener('click', closeModal);
    exitOverlay.addEventListener('click', (e) => { if (e.target === exitOverlay) closeModal(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && exitOverlay.classList.contains('active')) closeModal(); });
  }

  // MODIFICA: Logica per il menu a discesa mobile
  const mobileNavToggle = document.querySelector('.mobile-nav-toggle');
  const mobileDropdown = document.getElementById('mobile-dropdown');

  if (mobileNavToggle && mobileDropdown) {
    mobileNavToggle.addEventListener('click', (event) => {
      event.stopPropagation(); // Impedisce che il click si propaghi al document
      const isOpen = mobileDropdown.classList.toggle('is-open');
      mobileNavToggle.setAttribute('aria-expanded', isOpen);
      document.body.classList.toggle('mobile-nav-is-open', isOpen);
    });

    // Chiudi il menu se si clicca fuori
    document.addEventListener('click', (event) => {
      if (mobileDropdown.classList.contains('is-open') && !mobileNavToggle.contains(event.target)) {
        mobileDropdown.classList.remove('is-open');
        mobileNavToggle.setAttribute('aria-expanded', 'false');
        document.body.classList.remove('mobile-nav-is-open');
      }
    });
  }

  // ====== PAGE VIEW ======
  safeGtag('view_landing', { lang: 'it', variant });

})();
</script>
</body>
</html>

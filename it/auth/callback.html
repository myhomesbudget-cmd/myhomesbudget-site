<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Redirect...</title>
</head>
<body>
  <p>Attendi un attimo, ti stiamo reindirizzando alla tua dashboard...</p>

  <script type="module" src="/it/supabase-client.js"></script>
  <script type="module">
    import { supabase } from "/it/supabase-client.js";

    const lang = location.pathname.split('/')[1] || 'it';  
    const goDash = () => location.replace(`/${lang}/dashboard.html`);

    // ðŸ”¹ Recupera la sessione dopo il login (es. magic link)
    supabase.auth.onAuthStateChange((_event, session) => {
      if (session?.user) {
        goDash(); // se autenticato â†’ vai in dashboard
      } else {
        // fallback: se non autenticato â†’ torna al login
        location.replace(`/${lang}/login.html`);
      }
    });
  </script>
</body>
</html>

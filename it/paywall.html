<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fine Periodo di Prova — MyHomesBudget</title>
  <meta name="description" content="Il tuo periodo di prova è terminato. Scegli un piano per continuare a usare MyHomesBudget senza limiti.">
  <meta name="robots" content="noindex, nofollow">

  <!-- CSP -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' https: data:;
                 style-src 'self' 'unsafe-inline';
                 script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com;
                 connect-src 'self' https://www.google-analytics.com https://region1.google-analytics.com;
                 font-src 'self' https: data:;
                 frame-ancestors 'none';
                 base-uri 'self';
                 form-action 'self'">
  <meta name="referrer" content="strict-origin-when-cross-origin">

  <!-- GA4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LSD3V9G_DUMMY"></script><!-- ⬅️ metti il tuo ID -->
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-LSD3V9G_DUMMY', { anonymize_ip: true });
  </script>

  <!-- Performance -->
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
  <!-- Se usi redirect esterni -->
  <link rel="preconnect" href="https://checkout.stripe.com" crossorigin>
  <link rel="preconnect" href="https://www.paypal.com" crossorigin>

  <link rel="icon" href="/favicon.ico">
  <meta name="theme-color" content="#0f0f10">
  <meta name="color-scheme" content="light dark">

  <style>
    :root{font-family:-apple-system,system-ui,"Segoe UI",Roboto,sans-serif}
    *{box-sizing:border-box}
    a:focus-visible, button:focus-visible{outline:2px solid #00cec9; outline-offset:2px; border-radius:6px}

    body{
      margin:0;padding:0;color:#fff;
      background:url("/bg.webp") no-repeat center center fixed;
      background-size:cover;
      display:flex;flex-direction:column;min-height:100vh;
    }
    /* Velatura più scura per concentrare l'attenzione */
    body::before{content:"";position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:-1}

    .paywall-wrapper {
      flex-grow: 1;
      display: flex; align-items: center; justify-content: center;
      padding: 24px;
    }
    .paywall-panel{
      width: 100%; max-width: 720px;
      background:rgba(255,255,255,0.7);
      backdrop-filter:saturate(1.2) blur(8px);
      -webkit-backdrop-filter:saturate(1.2) blur(5px);
      color:#111;border-radius:16px;
      padding:clamp(1.2rem, 5vw, 2rem);
      box-shadow:0 10px 40px rgba(0,0,0,.15);
      text-align:center;
    }
    h1,h2,h3{margin:0 0 8px;text-shadow:0 1px 3px rgba(0,0,0,.4)}
    .copy{font-size:clamp(1rem, 2.5vw, 1.1rem); max-width:560px; margin:0 auto 24px; color:#333}

    /* Pricing */
    .pricing-grid{display:grid;gap:16px;grid-template-columns:1fr 1fr; margin-bottom: 24px;}
    @media(max-width:600px){.pricing-grid{grid-template-columns:1fr}}
    .price-card{
      background:rgba(255,255,255,.45);
      border:1px solid rgba(255,255,255,0.6);
      padding:18px;border-radius:12px;
      display:flex;flex-direction:column;gap:14px;text-align:center;
    }
    .plan-title{
      margin:0; display:flex; gap:.5rem; flex-wrap:wrap; align-items:baseline; justify-content:center;
      font-size:1.1rem;
    }
    .plan-name{font-weight:700}
    .sep{opacity:.45}
    .price-inline{font-weight:800; font-size:1.2rem; line-height:1}
    .price-inline small{font-weight:600; font-size:.9rem; color:#333}

    .cta-group{display:flex; flex-direction:column; gap:8px}
    .btn-payment{
      display:flex; align-items:center; justify-content:center; gap:8px;
      text-decoration:none; font-weight:700; border-radius:10px; padding:10px 14px;
      box-shadow:0 6px 18px rgba(0,0,0,.1);
      transition: transform .15s ease, filter .15s ease;
      border: none; cursor: pointer; font-size:.95rem;
    }
    .btn-payment:hover{filter:brightness(1.08); transform: translateY(-1px)}
    .btn-stripe{background:#635bff; color:#fff}
    .btn-paypal{background:#ffc439; color:#003087}

    /* FAQ rapida */
    .faq-condensed{text-align:left; margin-bottom: 24px}
    .faq-condensed h3{text-align:center; margin:0 0 12px; color:#111}
    .faq-item{font-size:.95rem; padding:8px 0; border-bottom:1px solid rgba(0,0,0,.08)}
    .faq-item:last-child{border-bottom:none}
    .faq-item strong{color:#111}
    .faq-item p{margin:4px 0 0; color:#444}

    /* Login hint */
    .login-prompt{margin-top:16px; padding:12px; background:rgba(0,0,0,.05); border-radius:8px; font-size:.9rem}
    .login-prompt a{color:#6c5ce7; font-weight:600; text-decoration:none}
    .login-prompt a:hover{text-decoration:underline}

    /* Reveal (top→bottom) */
    .reveal{opacity:0; transform:translateY(16px); transition:opacity .8s ease, transform .8s cubic-bezier(.22,1,.36,1)}
    .reveal.in{opacity:1; transform:none}
    @media (prefers-reduced-motion:reduce){.reveal,.reveal.in{transition:none; opacity:1; transform:none}}

    /* Utilità a11y */
    .visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}
  </style>
</head>
<body>

  <div class="paywall-wrapper">
    <!-- Page paywall (non modale) -->
    <main class="paywall-panel" role="document" aria-labelledby="paywall-title" aria-describedby="paywall-desc">
      <h1 id="paywall-title" class="reveal">Il tuo periodo di prova è terminato</h1>
      <p id="paywall-desc" class="copy reveal">Continua a usare MyHomesBudget senza limiti scegliendo un piano.</p>

      <!-- Piani -->
      <div class="pricing-grid">
        <section class="price-card reveal" aria-label="Piano Mensile 2,99 euro al mese">
          <h2 class="plan-title">
            <span class="plan-name">Piano Mensile</span>
            <span class="sep">—</span>
            <span class="price-inline">2,99€ <small>/ mese</small></span>
          </h2>
          <div class="cta-group">
            <a class="btn-payment btn-stripe"
               href="/checkout/stripe?plan=monthly&utm_source=paywall&utm_medium=web"
               data-plan="monthly" data-method="stripe">Paga con Stripe</a>
            <a class="btn-payment btn-paypal"
               href="/checkout/paypal?plan=monthly&utm_source=paywall&utm_medium=web"
               data-plan="monthly" data-method="paypal">Paga con PayPal</a>
          </div>
        </section>

        <section class="price-card reveal" aria-label="Piano Una Tantum 19,99 euro per sempre">
          <h2 class="plan-title">
            <span class="plan-name">Una Tantum</span>
            <span class="sep">—</span>
            <span class="price-inline">19,99€ <small>/ per sempre</small></span>
          </h2>
          <div class="cta-group">
            <a class="btn-payment btn-stripe"
               href="/checkout/stripe?plan=lifetime&utm_source=paywall&utm_medium=web"
               data-plan="lifetime" data-method="stripe">Paga con Stripe</a>
            <a class="btn-payment btn-paypal"
               href="/checkout/paypal?plan=lifetime&utm_source=paywall&utm_medium=web"
               data-plan="lifetime" data-method="paypal">Paga con PayPal</a>
          </div>
        </section>
      </div>

      <!-- FAQ -->
      <section class="faq-condensed reveal" aria-labelledby="faq-title">
        <h3 id="faq-title">Domande rapide</h3>
        <div class="faq-item">
          <strong>Cosa succede ai dati che ho inserito?</strong>
          <p>I tuoi dati restano al sicuro e si sbloccano subito dopo l’attivazione. Non cancelliamo nulla.</p>
        </div>
        <div class="faq-item">
          <strong>Quali metodi di pagamento accettate?</strong>
          <p>Carta tramite Stripe e pagamenti con conto PayPal. Tutte le transazioni sono sicure.</p>
        </div>
        <div class="faq-item">
          <strong>Posso cancellare il piano mensile quando voglio?</strong>
          <p>Sì, in qualsiasi momento. Continui ad avere accesso fino a fine periodo già pagato.</p>
        </div>
      </section>

      <!-- Login / Hai già un abbonamento? -->
      <p class="login-prompt reveal">
        Hai già un abbonamento attivo? <a href="/it/login.html">Accedi qui</a>
      </p>
    </main>
  </div>

  <noscript>
    <div style="max-width:720px;margin:16px auto;padding:12px;border-radius:8px;background:#fff;color:#111;text-align:center">
      Attiva JavaScript per completare il pagamento in modo corretto.
    </div>
  </noscript>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Page view
  gtag('event', 'paywall_viewed');

  // Checkout start (con metodo)
  document.querySelectorAll('a[data-plan][data-method]').forEach(link => {
    link.addEventListener('click', () => {
      gtag('event', 'checkout_started', {
        plan: link.dataset.plan,
        payment_method: link.dataset.method,
        source: 'paywall'
      });
    });
  });

  // Reveal sequenziale top→bottom (rispetta reduced motion)
  const targets = document.querySelectorAll('.reveal');
  if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    targets.forEach(el => el.classList.add('in')); return;
  }
  const ordered = [...targets].map(el => ({ el, r: el.getBoundingClientRect() }))
    .sort((a,b)=> (a.r.top - b.r.top) || (a.r.left - b.r.left))
    .map(x=>x.el);
  ordered.forEach((el, i) => el.style.transitionDelay = (i * 0.10) + 's');
  requestAnimationFrame(() => ordered.forEach(el => el.classList.add('in')));
});
</script>

</body>
</html>
